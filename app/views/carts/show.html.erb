<h1>Корзина</h1>

<table>
  <thead>
    <tr>
      <th>Назва</th>
      <th>Кількість</th>
      <th>Ціна</th>
      <th>Видалити</th>
    </tr>
  </thead>
  <tbody>
    <% @cart_items.each do |item| %>
      <tr>
        <td><%= item.product.name %></td>
        <td><%= item.quantity %></td>
        <td><%= number_to_currency(item.product.price * item.quantity) %></td>
        <td><%= link_to 'Видалити', remove_item_cart_path(item), method: :delete, data: { confirm: 'Ви впевнені?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<p>Загальна сума: <%= number_to_currency(@cart_items.sum { |item| item.product.price * item.quantity }) %></p>

<%= link_to 'Оформити замовлення', new_order_path, class: 'btn btn-primary' %>
<%= link_to 'Продовжити покупки', products_path, class: 'btn btn-secondary' %>

<h3>Оберіть доставку</h3>
<%= form_with(url: cart_select_delivery_path, method: :patch, local: true) do |form| %>
  <div class="form-group">
    <%= form.collection_select :delivery_option_id, DeliveryOption.all, :id, :name, include_blank: 'Оберіть спосіб доставки', class: 'form-control' %>
  </div>
  <%= form.submit 'Оновити доставку', class: 'btn btn-primary' %>
<% end %>
<%= button_to 'Оплатити', checkout_path, method: :post, class: 'btn btn-success' %>

